$global:maad_mitre_map = 
@{"AzureADRecon" = @{"tactic"="XYZ"; "technique"="XYZ"; "sub-technique"=""; "description"="XYZ"; "ref"="XYZ"}; 
"BackdoorAccountCreation" = @{"tactic"="Persistence"; "technique"="Create Account"; "sub-technique"="Cloud Account"; "description"="Adversaries create accounts to maintain access to target environment. With a sufficient level of access, creating such accounts establish secondary credentialed access."; "ref"="https://attack.mitre.org/techniques/T1136/003/"}; 
"CTSBackdoor" = @{"tactic"="Persistence"; "technique"="Create Account"; "sub-technique"="Cloud Account"; "description"="Adversaries create accounts to maintain access to target environment. With a sufficient level of access, creating such accounts establish secondary credentialed access."; "ref"="https://attack.mitre.org/techniques/T1136/003/"}; 
"TrustedNetworkConfig" = @{"tactic"="Defense Evasion"; "technique"="Impair Defenses"; "sub-technique"=""; "description"="Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as firewalls and anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may also span both native defenses as well as supplemental capabilities installed by users and administrators.`nAdversaries could also target event aggregation and analysis mechanisms, or otherwise disrupt these procedures by altering other system components."; "ref"="https://attack.mitre.org/techniques/T1562/"};  
"DisableMailboxAuditing" = @{"tactic"="Defense Evasion"; "technique"="Impair Defenses"; "sub-technique"=""; "description"="Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as firewalls and anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may also span both native defenses as well as supplemental capabilities installed by users and administrators.`nAdversaries could also target event aggregation and analysis mechanisms, or otherwise disrupt these procedures by altering other system components."; "ref"="https://attack.mitre.org/techniques/T1562/"}; 
"DisableAntiPhishing" = @{"tactic"="Defense Evasion"; "technique"="Impair Defenses"; "sub-technique"=""; "description"="Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as firewalls and anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may also span both native defenses as well as supplemental capabilities installed by users and administrators.`nAdversaries could also target event aggregation and analysis mechanisms, or otherwise disrupt these procedures by altering other system components."; "ref"="https://attack.mitre.org/techniques/T1562/"}; 
"MailboxDeleteRuleSetup" = @{"tactic"="Defense Evasion"; "technique"="Hide Artifacts"; "sub-technique"="Email Hiding Rules"; "description"="Adversaries may use email rules to hide inbound emails in a compromised user's mailbox. Many email clients allow users to create inbox rules for various email functions, including moving emails to other folders, marking emails as read, or deleting emails. Rules may be created or modified within email clients or through external features such as the New-InboxRule or Set-InboxRule PowerShell cmdlets on Windows systems.`nAdversaries may utilize email rules within a compromised user's mailbox to delete and/or move emails to less noticeable folders. Adversaries may do this to hide security alerts, C2 communication, or responses to Internal Spearphishing emails sent from the compromised account."; "ref"="https://attack.mitre.org/techniques/T1564/008/"}; 
"MailForwarding" = @{"tactic"="Collection"; "technique"="Email Collection"; "sub-technique"=""; "description"="Adversaries may target user email to collect sensitive information. Emails may contain sensitive data, including trade secrets or personal information, that can prove valuable to adversaries. Adversaries can collect or forward email from mail servers or clients."; "ref"="https://attack.mitre.org/techniques/T1114/"}; 
"GrantMailboxAccess" = @{"tactic"="Persistence"; "technique"="Account Manipulation"; "sub-technique"="Additional Email Delegate Permissions"; "description"="Adversaries may grant additional permission levels to maintain persistent access to an adversary-controlled email account. By assigning user permissions to a folder, the adversary can utilize any other account in the tenant to maintain persistence to the target users mail folders."; "ref"="https://attack.mitre.org/techniques/T1098/002/"}; 
"ExternalTeamsAccess" = @{"tactic"="Collection"; "technique"="Data from Information Repositories"; "sub-technique"=""; "description"="Adversaries may leverage information repositories to mine valuable information. Information repositories are tools that allow for storage of information, typically to facilitate collaboration or information sharing between users, and can store a wide variety of data that may aid adversaries in further objectives, or direct access to the target information.`nAdversaries may also abuse external sharing features to share sensitive documents with recipients outside of the organization."; "ref"="https://attack.mitre.org/techniques/T1213/"}; 
"eDiscovery" = @{"tactic"="Collection"; "technique"="Automated Collection"; "sub-technique"=""; "description"="Once established within a system or network, an adversary may use automated techniques for collecting internal data. Methods for performing this technique could include use of a Command and Scripting Interpreter to search for and copy information fitting set criteria such as file type, location, or name at specific time intervals. In cloud-based environments, adversaries may also use cloud APIs, command line interfaces, or extract, transform, and load (ETL) services to automatically collect data. This functionality could also be built into remote access tools."; "ref"="https://attack.mitre.org/techniques/T1119/"}; 
"BruteForce" = @{"tactic"="Credential Access"; "technique"="Brute Force"; "sub-technique"=""; "description"="Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes.`nBrute forcing credentials may take place at various points during a breach. For example, adversaries may attempt to brute force access to Valid Accounts within a victim environment leveraging knowledge gathered from other post-compromise behaviors such as OS Credential Dumping, Account Discovery, or Password Policy Discovery. Adversaries may also combine brute forcing activity with behaviors such as External Remote Services as part of Initial Access."; "ref"="https://attack.mitre.org/techniques/T1110/"}; 
"DisableMFA" = @{"tactic"="Defense Evasion"; "technique"="Modify Authentication Process"; "sub-technique"="Multi-Factor Authentication"; "description"="Adversaries may disable or modify multi-factor authentication (MFA) mechanisms to enable persistent access to compromised accounts.`nOnce adversaries have gained access to a network by either compromising an account lacking MFA or by employing an MFA bypass method such as Multi-Factor Authentication Request Generation, adversaries may leverage their access to modify or completely disable MFA defenses. This can be accomplished by abusing legitimate features, such as excluding users from Azure AD Conditional Access Policies, registering a new yet vulnerable/adversary-controlled MFA method, or by manually patching MFA programs and configuration files to bypass expected functionality."; "ref"="https://attack.mitre.org/techniques/T1556/006/"}; 
"SharepointExploiter" = @{"tactic"="Collection"; "technique"="Data from Information Repositories"; "sub-technique"="Sharepoint"; "description"="Adversaries may leverage the SharePoint repository as a source to mine valuable information. SharePoint will often contain useful information for an adversary to learn about the structure and functionality of the internal network and systems."; "ref"="https://attack.mitre.org/techniques/T1213/002/"}; 
"RemoveAccess" = @{"tactic"="Impact"; "technique"="Account Access Removal"; "sub-technique"=""; "description"="Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts."; "ref"="https://attack.mitre.org/techniques/T1531/"}; 
"ExternalRecon" = @{"tactic"="XYZ"; "technique"="XYZ"; "sub-technique"=""; "description"="XYZ"; "ref"="XYZ"}; 
"TORAnonymizer" = @{"tactic"="Command and Control"; "technique"="Proxy"; "sub-technique"="Multi-hop Proxy"; "description"="To disguise the source of malicious traffic, adversaries may chain together multiple proxies. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source. A particular variant of this behavior is to use onion routing networks, such as the publicly available TOR network."; "ref"="https://attack.mitre.org/techniques/T1090/003/"}};

function mitre_details ($module_name){
    Write-Host "`n###################################### MITRE ######################################" -ForegroundColor Gray
    try {
        Write-Host
        Write-Host "Tactic:" $global:maad_mitre_map[$module_name]["tactic"]`n -ForegroundColor Gray
        Write-Host "Technique:" $global:maad_mitre_map[$module_name]["technique"]`n -ForegroundColor Gray
        if ($global:maad_mitre_map[$module_name]["sub-technique"] -ne "") {
            Write-Host "Sub-Technique:" $global:maad_mitre_map[$module_name]["sub-technique"]`n -ForegroundColor Gray
        }
        Write-Host "Description:" $global:maad_mitre_map[$module_name]["description"]`n -ForegroundColor Gray
        Write-Host "Reference:" $global:maad_mitre_map[$module_name]["ref"] -ForegroundColor Gray
        Write-Host "`n###################################################################################" -ForegroundColor Gray
    }
    catch {
        #Do-nothing
    }
    Pause
    Write-Host ""
}